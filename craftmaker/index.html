<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="keywords" content="ufc, papercraft, face maker">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="author" content="UFC - SMD - Projeto Integrado 2 - 2020.2">
  <meta name="description" content="Craft Maker - Criador de Papercraft personalizado">
  <title>Craft Maker</title>

  <meta itemprop="name" content="Craft Maker">
  <meta itemprop="description" content="Craft Maker - Criador de Papercraft personalizado - UFC - SMD - Projeto Integrado 2 - 2020.2">
  <meta itemprop="image" content="img/favicon.png">


  <link rel="apple-touch-icon" sizes="72x72" href="img/favicon.png">
  <link rel="apple-touch-icon" sizes="128x128" href="img/favicon.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/favicon.png">
  <link rel="apple-touch-icon" sizes="192x192" href="img/favicon.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="img/favicon.png">
  <link rel="icon" type="image/x-icon" sizes="16x16" href="img/favicon.png">

  <!-- theme-color -->
  <meta name="theme-color" content="#cacaca50" />
  <!-- end-theme-color -->

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
  <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
  
  <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon" />
</head>
  
<body>
<!-- Wide card with share menu button -->
<style>
  html, body {
    margin: auto;
    max-width: 960px;
  }
  .mdl-layout__content {
    background-color: #cacaca50;
  }
  .card-wide > .mdl-card__title {
    color: #000;
  }
</style>
<div class="mdl-layout__content" id="main-drop">
  <div class="mdl-grid">
    <div class="mdl-cell mdl-cell--6-col card-wide mdl-card mdl-shadow--2dp">
      <div class="mdl-card__title">
        <a class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect" id="download" download="myCraft.jpg" onclick="download_img(this);">
          <i class="material-icons">vertical_align_bottom</i>
        </a>
      </div>
      <div class="mdl-grid" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="cabecaAtual" src="img/cabeca.png" height="0%" width="0%" />
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"><img id="sobrancelhaAtual" src="img/sobrancelha01.png" height="100%" width="100%" /></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"><img id="olhosAtual" src="img/olho01.png" height="100%" width="100%" /></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"><img id="narizAtual" src="img/nariz02.png" height="100%" width="100%" /></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"></div>
        <div class="mdl-cell--4-col"><img id="bocaAtual" src="img/boca04.png" height="100%" width="100%" /></div>
        <div class="mdl-cell--4-col"></div>
      </div>
    </div>

    <div class="mdl-cell mdl-cell--6-col menu">
      <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
        <div class="mdl-tabs__tab-bar">
          <a href="#sobrancelha-panel" class="mdl-tabs__tab"><img alt="Sobrancelha" src="img/ico-sobrancelha.png" /></a>
          <a href="#olho-panel" class="mdl-tabs__tab is-active"><img alt="Olho" src="img/ico-olho.png" /></a>
          <a href="#nariz-panel" class="mdl-tabs__tab"><img alt="Nariz" src="img/ico-nariz.png" /></a>
          <a href="#boca-panel" class="mdl-tabs__tab"><img alt="Boca" src="img/ico-boca.png" /></a>
        </div>
        <div class="mdl-tabs__panel" id="sobrancelha-panel">
          <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--2-col" onclick="sobrancelha.src = 'img/sobrancelha01.png';"><img id="sobrancelha1" draggable="true" ondragstart="drag(event)" src="img/sobrancelha01.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="sobrancelha.src = 'img/sobrancelha02.png';"><img id="sobrancelha2" draggable="true" ondragstart="drag(event)" src="img/sobrancelha02.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="sobrancelha.src = 'img/sobrancelha03.png';"><img id="sobrancelha3" draggable="true" ondragstart="drag(event)" src="img/sobrancelha03.png" width="100%" /></div>
          </div>
        </div>
        <div class="mdl-tabs__panel is-active" id="olho-panel">
          <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--2-col" onclick="olho.src = 'img/olho01.png';"><img id="olhos1" draggable="true" ondragstart="drag(event)" src="img/olho01.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="olho.src = 'img/olho02.png';"><img id="olhos2"draggable="true" ondragstart="drag(event)" src="img/olho02.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="olho.src = 'img/olho03.png';"><img id="olhos3"draggable="true" ondragstart="drag(event)" src="img/olho03.png" width="100%" /></div>
          </div>
        </div>
        <div class="mdl-tabs__panel" id="nariz-panel">
          <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--2-col" onclick="nariz.src = 'img/nariz01.png';"><img id="nariz1" draggable="true" ondragstart="drag(event)" src="img/nariz01.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="nariz.src = 'img/nariz02.png';"><img id="nariz2" draggable="true" ondragstart="drag(event)" src="img/nariz02.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="nariz.src = 'img/nariz03.png';"><img id="nariz3" draggable="true" ondragstart="drag(event)" src="img/nariz03.png" width="100%" /></div>
          </div>
        </div>
        <div class="mdl-tabs__panel" id="boca-panel">
          <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--2-col" onclick="boca.src = 'img/boca01.png';"><img id="boca1" draggable="true" ondragstart="drag(event)" src="img/boca01.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="boca.src = 'img/boca02.png';"><img id="boca2" draggable="true" ondragstart="drag(event)" src="img/boca02.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="boca.src = 'img/boca03.png';"><img id="boca3" draggable="true" ondragstart="drag(event)" src="img/boca03.png" width="100%" /></div>
            <div class="mdl-cell mdl-cell--2-col" onclick="boca.src = 'img/boca04.png';"><img id="boca4" draggable="true" ondragstart="drag(event)" src="img/boca04.png" width="100%" /></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<canvas id="canva_craft"></canvas>

<script type="text/javascript">
const sobrancelha = document.getElementById("sobrancelhaAtual");
const olho = document.getElementById("olhosAtual");
const nariz = document.getElementById("narizAtual");
const boca = document.getElementById("bocaAtual");

function allowDrop(ev) {
  ev.preventDefault();
}

function drag(ev) {
  ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev) {
  ev.preventDefault();
  var data = ev.dataTransfer.getData("text");
  var nodeCopy = document.getElementById(data).cloneNode(true);
  var src = nodeCopy.src;
  switch (nodeCopy.id.substring(0,4)) {
    case "sobr":
      sobrancelha.src = src;
      break;
    case "olho":
      olho.src = src;
      break;
    case "nari":
      nariz.src = src;
      break;
    case "boca":
      boca.src = src;
      break;
    default:

  }
}

download_img = function(el) {
  const canva_craft = document.createElement("canvas");
  // const canva_craft = document.getElementById("canva_craft");
  // canva_craft.width = 800;//document.getElementById("main-drop").offsetHeight;
  // canva_craft.height = 1100;//document.getElementById("main-drop").offsetHeight;
  const context = canva_craft.getContext('2d');
  context.clearRect(0, 0, canva_craft.width, canva_craft.height);

  const cabeca = document.getElementById("cabecaAtual");

  var imgRosto = new Image();
  imgRosto.src =  cabeca.src;
  imgRosto.width = 800;
  imgRosto.height = 1100;

  var imgSobrancelha = new Image();
  imgSobrancelha.src = sobrancelha.src;

  var imgOlho = new Image();
  imgOlho.src = olho.src;

  var imgNariz = new Image();
  imgNariz.src = nariz.src;
  imgNariz.width = 420;
  imgNariz.height = 215;

  var imgBoca = new Image();
  imgBoca.src = boca.src;
  imgBoca.width = 300;
  imgBoca.height = 150;

  drawCanv = function() {
    context.drawImage(imgRosto, 0, 0, imgRosto.width, imgRosto.height);
    context.drawImage(imgSobrancelha, 115, 310, imgSobrancelha.width, imgSobrancelha.height);
    context.drawImage(imgOlho, 95, 380, imgOlho.width, imgOlho.height);
    context.drawImage(imgNariz, 200, 430, imgNariz.width, imgNariz.height);
    context.drawImage(imgBoca, 250, 650, imgBoca.width, imgBoca.height);
  }
  drawCanv();

  var image = canva_craft.toDataURL("image/jpg");
  el.href = image;
};
</script>
</body>
</html>